{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\GameManager.js"],"names":["randomParagraph","require","cc","Class","extends","Component","properties","avatar","Sprite","userName","Label","content","inputField","EditBox","index","timeAttack","timerShark","timer","timerPlay","isStart","isWait","isEnd","scoreTxt","wpmDisplay","Node","player","shark","onLoad","richText","string","sentences","Words","trim","split","filter","word","length","greenToYellow","yellowToRed","correctWords","wrongWords","start","onTextChanged","event","value","blur","focus","CheckWord","getComponent","getHit","attack","engryControl","blockEdittext","heath","die","onEnable","jsonString","sys","localStorage","getItem","jsonData","JSON","parse","name","changeAvatar","imageIndex","error","node","opacity","openEditText","update","dt","isDeath","active","display","checkAction","alpha","parseFloat","toFixed"],"mappings":"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","file":"GameManager.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["var randomParagraph = require('random-paragraph');\r\ncc.Class({\r\n  extends: cc.Component,\r\n\r\n  properties: {\r\n    avatar: cc.Sprite,\r\n    userName: cc.Label,\r\n    content: cc.Label,\r\n    inputField: cc.EditBox,\r\n    index: 0,\r\n    timeAttack: 7,\r\n    timerShark:0,\r\n    timer:0,\r\n    timerPlay: 0,\r\n    isStart: true,\r\n    isWait:false,\r\n    isEnd:false,\r\n    scoreTxt: cc.Label,\r\n    wpmDisplay: cc.Node,\r\n    player:cc.Node,\r\n    shark:cc.Node\r\n  },\r\n  onLoad() {\r\n    this.content.richText = true;\r\n    let string= randomParagraph({ sentences: 1 });\r\n    this.Words = string.trim().split(/\\s+/).filter(word => word.length > 0);\r\n    this.content.string= this.Words[this.index]\r\n    this.greenToYellow = 0;\r\n    this.yellowToRed = 0;\r\n    this.correctWords = 0;\r\n    this.wrongWords = 0;\r\n    this.scoreTxt.string = \"Score:\" + this.correctWords;\r\n  },\r\n  start() {\r\n\r\n  },\r\n  onTextChanged(event) {\r\n    let string = this.inputField.string;\r\n    if (string[string.length - 1] == \" \") {\r\n      let value = this.inputField.string.trim();\r\n      if(this.isWait==false){\r\n        this.inputField.string = '';\r\n        this.inputField.blur();\r\n        this.inputField.focus();\r\n        this.CheckWord(value);\r\n      }else{\r\n        this.inputField.string = value;\r\n        this.inputField.blur();\r\n        this.inputField.focus();\r\n      }\r\n      \r\n    }\r\n  },\r\n  CheckWord(word) {\r\n    if (word == this.Words[this.index]) {\r\n      this.correctWords++;\r\n      this.scoreTxt.string = \"Score:\" + this.correctWords;\r\n      this.shark.getComponent('Shark').getHit(1);\r\n      this.player.getComponent('Player').attack();\r\n      this.shark.getComponent('Shark').engryControl(0.1,0);\r\n      this.timerShark=0;\r\n      this.blockEdittext();\r\n      this.isWait=true;\r\n    } else {\r\n      this.wrongWords++;\r\n      this.blockEdittext()\r\n      this.isWait=true;\r\n      this.shark.getComponent('Shark').attack();\r\n      this.shark.getComponent('Shark').engryControl(0.1,0);\r\n      this.player.getComponent('Player').getHit(1,0.1);\r\n      this.timerShark=0;\r\n      if(this.player.getComponent('Player').heath<=0){\r\n        this.player.getComponent('Player').die(1);\r\n        this.isEnd=true;\r\n      }\r\n    }\r\n    this.index++;\r\n    if(this.index%5==0&&this.timeAttack>3)this.timeAttack--\r\n    if(this.index!=this.Words.length){\r\n        this.content.string= this.Words[this.index];\r\n    }else{\r\n      this.blockEdittext();\r\n      this.isWait=true;\r\n      this.scoreTxt.string = \"Score:\" + this.correctWords;\r\n      this.shark.getComponent('Shark').die(1);\r\n      this.player.getComponent('Player').attack();\r\n      this.shark.getComponent('Shark').engryControl(0.1,0);\r\n      this.isEnd=true;\r\n      //chiến thắng tính điểm\r\n    }\r\n  },\r\n  onEnable() {\r\n    this.inputField.focus();\r\n    this.jsonString = cc.sys.localStorage.getItem(\"playerData\");\r\n    this.jsonData = null;\r\n    if (this.jsonString) {\r\n      this.jsonData = JSON.parse(this.jsonString);\r\n      this.userName.string = this.jsonData.name;\r\n      this.avatar.getComponent(\"LoadAtlas\").changeAvatar(this.jsonData.imageIndex);\r\n    } else {\r\n      cc.error(\"Không thấy data\");\r\n    }\r\n  },\r\n  blockEdittext(){\r\n    this.inputField.node.opacity=100;\r\n  },\r\n  openEditText(){\r\n    this.inputField.node.opacity=255;\r\n  },\r\n  update(dt) {\r\n    if(this.isEnd==true){\r\n      if(this.player.getComponent('Player').isDeath==true||this.shark.getComponent('Shark').isDeath==true){\r\n        this.wpmDisplay.active=true;\r\n        this.wpmDisplay.getComponent('WPMScore').display(this.correctWords,this.wrongWords,this.timerPlay)\r\n      }\r\n    }\r\n    if(this.shark.getComponent('Shark').checkAction()){\r\n      \r\n      this.openEditText();\r\n      this.isWait=false;\r\n    }\r\n    if (this.isStart&&this.isWait==false&&this.isEnd==false) {\r\n      this.timer+=dt;\r\n      this.timerPlay+=dt;\r\n      this.timerShark+=dt;\r\n      if(this.timer>=1){\r\n        this.timer=0;\r\n        const alpha=parseFloat((this.timerShark/this.timeAttack).toFixed(1));\r\n        this.shark.getComponent('Shark').engryControl(0.5,alpha);\r\n        if(alpha>=1){\r\n          this.shark.getComponent('Shark').attack();\r\n          this.player.getComponent('Player').getHit(1,0.1);\r\n          this.shark.getComponent('Shark').engryControl(0.1,0);\r\n          if(this.player.getComponent('Player').heath<=0.01){\r\n            this.player.getComponent('Player').die(1);\r\n            this.isEnd=true;\r\n          }\r\n          this.timerShark=0;\r\n          this.blockEdittext()\r\n          this.isWait=true;\r\n        }\r\n      }\r\n    }\r\n  },\r\n});\r\n"]}